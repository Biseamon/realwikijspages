<!--
title: Oobeedoo_85493802
description: 
published: true
date: 2020-12-02T12:12:06.911Z
tags: 
editor: undefined
dateCreated: 2020-12-02T12:04:18.607Z
-->

<!DOCTYPE html>
<html>
    <head>
        <title>Blueberry Group : Oobeedoo</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">Blueberry Group</a></span>
                            </li>
                                                    <li>
                                <span><a href="Project-Information_85493575.html">Project Information</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            Blueberry Group : Oobeedoo
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
        
    
        
        
            Created by <span class='author'> Jason Cozza</span> on Nov 24, 2020
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <h1 id="Oobeedoo-GitLab:">GitLab:</h1><p><a class="external-link" href="https://gitlab.bbconsult.co.uk/blueberry/oobeedoo/-/tree/master" rel="nofollow">https://gitlab.bbconsult.co.uk/blueberry/oobeedoo/-/tree/master</a></p><h1 id="Oobeedoo-DeviceHardware">Device Hardware</h1><ul><li>PI 3a+</li><li>32gb micro SD card</li><li>Speaker (driver)</li><li>Adafruit MAX98357 I2S Class-D Mono Amp</li><li>PTM button</li></ul><p><br/></p><h1 id="Oobeedoo-SetupInstructions">Setup Instructions</h1><p>Use case – initial setup</p><ol><li>Create an account on the Oobeedoo mobile application</li><li>Plug the device in</li><li>Power device up</li><li>Wait for audio instructions</li><li>If no user found<ol><li>Hold button for &gt; 5 &lt; 10 seconds</li><li>Wait for audio instructions</li><li>Connect to Oobeedoo Wi-Fi from laptop or phone<ol><li>Sign in to Oobeedoo account</li><li>Sign in to Premium Spotify* account</li><li>Sign in to local Wi-Fi</li><li>Wait for audio instructions (from device)</li></ol></li><li>Go to Oobeedoo webpage (<a class="external-link" href="https://dashboard.oobeedoo.co.uk" rel="nofollow">https://dashboard.oobeedoo.co.uk</a>)<ol><li>Sign in</li><li>Navigate to ‘Devices’ page (left hand side of screen)</li><li>Click ‘Manage’ under Oobeedoo</li><li>Navigate to ‘Music Providers’ page (left hand side of screen)</li><li>Click Connect under Spotify</li><li>Wait for audio instructions (from device)</li></ol></li><li>Device will reboot</li></ol></li><li>Device logged in</li><li>Press button for &lt; 5 seconds (normal click) to play music</li><li>Music will need to be added to default playlist on the webpage to work</li><li>Device will play music<br/><br/></li></ol><h1 id="Oobeedoo-BUGNOTICE:">BUG NOTICE:</h1><p>If device reboots after step 5.e. and indicates through audio that no user has been found a second reboot by holding the button for &gt; 10 seconds will often fix this issue.</p><p>If you hold the button for under 10 seconds it will remove the user settings and a setup will have to take place again.</p><h2 id="Oobeedoo-Usecase–settingupwithadifferentaccount">Use case – setting up with a different account</h2><p>Set up is the same as above but at step 5 when a user is found go to step 5.a.</p><h2 id="Oobeedoo-Usecase–daytodayuseaftersetup">Use case – day to day use after setup</h2><p>If the device has been fully setup, day to day use will be powering up the device, device will log in to users account and Spotify and a click of the button will play/stop the music that has been pre-set in the default playlist on the oobeedoo dashboard.</p><p>If the device cannot connect to the WIFI it will alert the user through and audio warning.</p><p><br/></p><h1 id="Oobeedoo-ButtonControls">Button Controls</h1><p>Single button press – will play/stop music if logged in if not will give audio instructions to sign in.</p><p>Button hold for 5 seconds – Device will go into setup mode, step (5.a.).</p><p>Button hold for more than 10 seconds – Device will soft reboot.</p><p><br/></p><h1 id="Oobeedoo-CodeandIssues">Code and Issues</h1><h2 id="Oobeedoo-MainCurrentIssue:">Main Current Issue:</h2><p>Once a device has been connected and gone through the setup process it will not retain the user credentials. Although this is somewhat not true as the device will often still connect to the local Wi-Fi correctly,</p><p>therefore the device is holding at least the Wi-Fi information but the program is not recognising this on reboot (step 5.e. + 6.).</p><p>On occasion this can be subverted by holding the device button for more than 10 seconds calling a soft reboot (sudo shutdown -r now). Once the device has rebooted it will then recognise the account and sign in.</p><h2 id="Oobeedoo-PossibleCauses:">Possible Causes:</h2><ol><li>The device on boot could be passing the code of signing in before the device has had time to connect to the internet therefore not being able to verify the account it will assert no details recognised.</li><li>A previous bug caused the resin Wi-Fi connect (step 5.c.) to never close, this meant that after a user signed in the instructions and next process (step 5.c.iv) would never happen. <br/>It was concluded from looking at the PI’s running processes that this was holding the device in a lock therefore killing the process after the details has been taken fixed this. But this may have caused this to be unstable. <br/>Tests at the developers WFH location on 3 different Wi-Fi networks passed, yet this may be causing the issue for the speaker manufacture. Could be killing the process before the details have been stored.<br/> Location on device ‘/oobeedoo/src/oobeedoo_player.py’. Code Lines ~258 – 262.<br/><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="114" src="attachments/85493802/85493803.png" data-image-src="attachments/85493802/85493803.png" data-unresolved-comment-count="0" data-linked-resource-id="85493803" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image2020-8-10_10-52-45.png" data-base-url="https://wiki.bbconsult.co.uk" data-linked-resource-content-type="image/png" data-linked-resource-container-id="85493802" data-linked-resource-container-version="1"></span></li><li>User details are wrong and the code only asserts details not found through audio instructions.</li></ol><h1 id="Oobeedoo-Connection">Connection</h1><p>Device will display its IP address on screen upon boot.</p><p>From Terminal:</p><p>SSH pi@IPAddress</p><p><br/></p><h1 id="Oobeedoo-Passwords">Passwords</h1><p>The main Password for the device is contained within the company Bit-Warden.</p><p><br/></p><h1 id="Oobeedoo-Thingstonote">Things to note</h1><p><em>Display</em> - Pi may not display on older screens due to the HDMI configs, plugging into a tv often works.</p><p><em>Volume</em> – Volume of the device is not constant/consistent, although this is set during the setup in the main python code to be 80% and the firebase values are set to around this it reverts to a much lower volume inconsitantly.</p><p><em>Audio</em> – Audio often contains artefacts on start-up.</p><p><em>IMG</em> – IMG for the software is bloated, it sits at 32GB but this is mainly empty space it can be taken down to around 4GB by deleting the empty space.</p><p><em>Website</em> – The website will only allow one playlist for music, will also create an additional device every time the oobeedoo is set up on the account it will not replace duplicate devices.</p><p>Therefore when on each time setting the device up you will have to find the newest device and connect that to the Spotify.</p><p>Note: Change the name of each device you add to a number so you can see the new device which will always be named Oobeedoo.</p>
                    </div>

                                        <div class="pageSection group">
                        <div class="pageSectionHeader">
                            <h2 id="attachments" class="pageSectionTitle">Attachments:</h2>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/85493802/85493803.png">image2020-8-10_10-52-45.png</a> (image/png)
                                <br/>
                                                    </div>
                    </div>
                    
                 
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Dec 02, 2020 11:32</p>
                    <div id="footer-logo"><a href="http://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
