<!--
title: Amazon Web Services: Deploying a stable stage of an API gateway calling Lambda
description: 
published: true
date: 2020-12-02T14:31:26.675Z
tags: 
editor: ckeditor
dateCreated: 2020-12-02T12:00:09.672Z
-->

<h1>Blueberry Group : Amazon Web Services: Deploying a stable stage of an API gateway calling Lambda&nbsp;</h1>
<p>Created by Jason Cozza on Nov 24, 2020</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2>Amazon Web Services: Create a new versioned Lambda Function</h2>
<ul>
  <li>First go to the Function console <a href="https://console.aws.amazon.com/lambda/home?region=us-east-1#/functions?display=list">https://console.aws.amazon.com/lambda/home?region=us-east-1#/functions?display=list</a> and click on the function name you want to create a new version of.</li>
  <li>On the action menu select Publish new version a pop up will asking to enter a description of the version.</li>
</ul>
<figure class="image"><img src="attachments/85493727/85493737.png"></figure>
<figure class="image"><img src="attachments/85493727/85493736.png"></figure>
<p>&nbsp;</p>
<ul>
  <li>Press the publish button once you added some useful text to the description.</li>
  <li>Once publish you will be sent on the version page of the lambda. Although it says you are now viewing the code of new version it is not the case this is why given a good description of the version is useful to recognize it.<br>Note that the Qualifiers button change to Version: [id]</li>
</ul>
<figure class="image"><img src="attachments/85493727/85493735.png"></figure>
<figure class="image"><img src="attachments/85493727/85493734.png"></figure>
<p>&nbsp;</p>
<ul>
  <li>Switching from one version to another can be done by pressing&nbsp; the “Version : [id]” / “Qualifiers” button and selecting the version id on the versions tab.</li>
</ul>
<figure class="image"><img src="attachments/85493727/85493733.png"></figure>
<h2>Amazon Web Services: Call lambda on API Gateway by its version</h2>
<ul>
  <li>Go to the AWS API Gateway console and select your API.</li>
  <li>Under resource select the method you want to change lambda version.</li>
  <li>Go to the Integration Request.</li>
</ul>
<figure class="image"><img src="attachments/85493727/85493732.png"></figure>
<figure class="image"><img src="attachments/85493727/85493731.png"></figure>
<p>&nbsp;</p>
<ul>
  <li>Click on the Pen next to “Lambda Function” and add “:” + the version id to the function name.</li>
  <li>Press the check mark to save the change.</li>
  <li>Repeat process for all method you’d like to use lambda function.</li>
</ul>
<figure class="image"><img src="attachments/85493727/85493730.png"></figure>
<p>&nbsp;</p>
<ul>
  <li>Then deploy the api to an existing stage or create a new stage using the action button, Deploy API option.</li>
</ul>
<figure class="image"><img src="attachments/85493727/85493729.png"></figure>
<figure class="image"><img src="attachments/85493727/85493728.png"></figure>
<p>The method will now call the versioned lambda instead of the latest lambda.</p>
<p>&nbsp;</p>
<h2>Attachments:</h2>
<figure class="image"><img src="images/icons/bullet_blue.gif" alt=""></figure>
<p><a href="attachments/85493727/85493728.png">API Gateway Stage deployment.png</a> (image/png)&nbsp;<br>&nbsp;</p>
<figure class="image"><img src="images/icons/bullet_blue.gif" alt=""></figure>
<p><a href="attachments/85493727/85493729.png">API Gateway Action.png</a> (image/png)&nbsp;<br>&nbsp;</p>
<figure class="image"><img src="images/icons/bullet_blue.gif" alt=""></figure>
<p><a href="attachments/85493727/85493730.png">API Gateway Integration Request window.png</a> (image/png)&nbsp;<br>&nbsp;</p>
<figure class="image"><img src="images/icons/bullet_blue.gif" alt=""></figure>
<p><a href="attachments/85493727/85493731.png">API Gateway Integration Request.png</a> (image/png)&nbsp;<br>&nbsp;</p>
<figure class="image"><img src="images/icons/bullet_blue.gif" alt=""></figure>
<p><a href="attachments/85493727/85493732.png">API Gateway API.png</a> (image/png)&nbsp;<br>&nbsp;</p>
<figure class="image"><img src="images/icons/bullet_blue.gif" alt=""></figure>
<p><a href="attachments/85493727/85493733.png">Function Version navigation.png</a> (image/png)&nbsp;<br>&nbsp;</p>
<figure class="image"><img src="images/icons/bullet_blue.gif" alt=""></figure>
<p><a href="attachments/85493727/85493734.png">Function Version created.png</a> (image/png)&nbsp;<br>&nbsp;</p>
<figure class="image"><img src="images/icons/bullet_blue.gif" alt=""></figure>
<p><a href="attachments/85493727/85493735.png">Function Version Description.png</a> (image/png)&nbsp;<br>&nbsp;</p>
<figure class="image"><img src="images/icons/bullet_blue.gif" alt=""></figure>
<p><a href="attachments/85493727/85493736.png">Function Action.png</a> (image/png)&nbsp;<br>&nbsp;</p>
<figure class="image"><img src="images/icons/bullet_blue.gif" alt=""></figure>
<p><a href="attachments/85493727/85493737.png">Function console.png</a> (image/png)&nbsp;<br>&nbsp;</p>
<p>Document generated by Confluence on Dec 02, 2020 11:32</p>
<p><a href="http://www.atlassian.com/">Atlassian</a></p>
