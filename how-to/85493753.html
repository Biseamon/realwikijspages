<!--
title: Parcel SafePlace (PackageRoom) iPad application
description: 
published: true
date: 2020-12-02T14:25:18.589Z
tags: 
editor: undefined
dateCreated: 2020-12-02T12:00:18.477Z
-->

<h1>Blueberry Group : Parcel SafePlace (PackageRoom) iPad application&nbsp;</h1>
<p>Created by Jason Cozza on Nov 24, 2020</p>
<p>This document aims to describe the build and release process for the Parcel SafePlace iPad application.</p>
<h1>Source code</h1>
<p>The source code for the application resides in the <a href="https://svn.bbconsult.co.uk/repository/packageroom/trunk/iPad%20application/">packageroom</a> repository. Use SVN to checkout the code to somewhere on your Mac that Xcode can see.</p>
<p>A VM has already been set up within the Birmingham office with the necessary tools and configuration to release the application. See the BitWarden note 'macOS VM: Parcel Safeplace'.</p>
<p>&nbsp;</p>
<h1>Build environment</h1>
<p>The iPad application requires the following to build:</p>
<ul>
  <li>Xcode</li>
  <li>Developer certificates, either personal or from the <strong>Parcel Safe Place Limited</strong> account</li>
</ul>
<p>The iPad application requires the following to release:</p>
<ul>
  <li>Xcode Organiser / Application Loader</li>
  <li>Being part of the Parcel Safe Place Limited enterprise team (ask Ben Waters at Parcel Safeplace for help with this)</li>
  <li>Possessing the Parcel Safeplace distribution certificate</li>
</ul>
<h2>Preparing the environment</h2>
<p>Open&nbsp;<strong>Xcode&nbsp;→ Preferences</strong> and add the account you used to join the Parcel Safeplace Limited enterprise team. In our case, this is <strong>apple@bbconsult.co.uk</strong>, the details of which are in the 'BB Consult Dev Account' BW note.&nbsp;Once signed in, click <strong>View Details...</strong> when highlighting the&nbsp;<strong>Parcel Safe Place Limited</strong> team&nbsp;and ensure that iOS development and iOS distribution certificates are on your machine. If they aren't, use the&nbsp;<strong>Create</strong>&nbsp;button to request them. Download any provisioning profiles using the&nbsp;<strong>Download all&nbsp;</strong>button.</p>
<p>If the distribution certificate needs renewing or resetting, follow the instructions at <a href="https://developer.apple.com">developer.apple.com</a> in the&nbsp;<strong>Certificates, Identifiers &amp; Profiles</strong>&nbsp;page, otherwise skip to the next section. Click&nbsp;<strong>Certificates&nbsp;→ Production&nbsp;</strong>and follow the instructions. You'll need to generate a certificate signing request using the&nbsp;<strong>Keychain Access</strong> app on your Mac. Click&nbsp;<strong>Keychain Access&nbsp;→ Certificate Assistant&nbsp;→ Request a Certificate from a Certificate Authority.</strong> Use&nbsp;<strong>admin@parcelsafeplace.com&nbsp;</strong>in the email field,&nbsp;<strong>Parcel SafePlace&nbsp;</strong>in the common name field, and leave the CA email field blank.</p>
<figure class="image"><img src="attachments/85493753/85493754.png"></figure>
<p>Click the option to save the file to disk. Now upload the CSR when requested by the certificate request wizard on the Apple developer portal, and it should return a new certificate which you can then import back into&nbsp;<strong>Keychain Access</strong> using&nbsp;<strong>File&nbsp;→ Import</strong>. You should now see the new certificate in the&nbsp;<strong>login</strong> keychain. The old distribution certificate/key can safely be removed. The instructions are the same for normal developer certificates, just choose&nbsp;<strong>Certificates&nbsp;→ Development&nbsp;</strong>in the developer portal.</p>
<p>As you've created a new distribution certificate, you need to also create a new distribution provisioning profile, or edit the existing one to point to the new certificate and then download it in Xcode again. To create a new profile, select&nbsp;<strong>Provisioning Profiles&nbsp;→ Distribution</strong> in the developer portal and click the&nbsp;<strong>+</strong> icon, select App Store distribution, ensure that the correct app ID (com.parcelsafeplace) is selected, then select the new certificate you generated earlier. To edit an existing profile, select it and click&nbsp;<strong>Edit</strong>, then select the new distribution certificate you created earlier. Either option will generate a new profile, which you can then download in the Xcode account details pane.</p>
<h2>Sharing certificates/keys across machines</h2>
<p>While provisioning profiles can be downloaded again to a new machine via Xcode, the private key tied to a certificate is stored in the keychain of the Mac which generated the initial CSR. To migrate or share the certificate, the key must be exported alongside it. Right click the certificate in&nbsp;<strong>Keychain Access</strong> and select the export option. Save it somewhere, and encrypt it with a password when prompted. Use the&nbsp;<strong>File&nbsp;→ Import</strong> option on the destination machine and use the same password to decrypt when importing. Delete exported file when finished.</p>
<h1>Building and running the application</h1>
<p>Open the project in Xcode and ensure that the&nbsp;<strong>Parcel Safe Place Limited</strong>&nbsp;team is selected.</p>
<p>Select the correct scheme using the scheme menu in Xcode.</p>
<figure class="image"><img src="attachments/85493753/85493755.png?effects=drop-shadow"></figure>
<p>Click the play icon on the control bar across the top of Xcode to run the app with the active scheme.</p>
<p>Alternatively, use the&nbsp;<strong>Product</strong> menu to build without running, or run the last built version of the app.</p>
<p>Connect an iPad and select it from the scheme menu if you want to test on a physical device. This will require you to trust your Mac on the iPad, and will trigger Xcode to generate provisioning profiles for the device.</p>
<h1>Releasing the application</h1>
<p>Parcel Safeplace used to use Testflight as a distribution mechanism, but have switched to using Miradore as an MDM solution and also use it to distribute applications.</p>
<p>Ensure that you've selected a valid scheme for release. If in doubt, select the&nbsp;<strong>Generic iOS Device</strong> scheme.</p>
<p>Once you're ready to release, increment the build number in the <strong>General</strong> tab, and&nbsp;use the&nbsp;<strong>Product&nbsp;→ Archive</strong> menu to prepare a release.</p>
<p>In the organizer window, select the newly built archive and select&nbsp;<strong>Distribute App</strong>. Choose manual signing, and select 'Ad Hoc' distribution, and select the appropriate distribution certificate when prompted.</p>
<p>Alternatively, you can use the&nbsp;<strong>Application Loader </strong>in the&nbsp;<strong>Window</strong> menu of Xcode. This is not covered in this article.</p>
<p>The signed IPA is then sent to our contact at Parcel Safeplace via email. At the time of writing, this is Ben Waters.</p>
<h1>Adding devices to the provisioning profile</h1>
<p>Occasionally, Parcel Safeplace may want to add new devices to the provisioning profile used for distribution. Simply add the devices in the Apple developer portal, regenerate the profile, and then import it into Xcode.</p>
<h2>Attachments:</h2>
<figure class="image"><img src="images/icons/bullet_blue.gif" alt=""></figure>
<p><a href="attachments/85493753/85493754.png">Screen Shot 2018-04-05 at 10.27.29.png</a> (image/png)&nbsp;<br>&nbsp;</p>
<figure class="image"><img src="images/icons/bullet_blue.gif" alt=""></figure>
<p><a href="attachments/85493753/85493755.png">Screen Shot 2018-04-04 at 14.05.14.png</a> (image/png)&nbsp;<br>&nbsp;</p>
<p>Document generated by Confluence on Dec 02, 2020 11:32</p>
<p><a href="http://www.atlassian.com/">Atlassian</a></p>
