<!--
title: 85493322
description: 
published: true
date: 2020-12-01T15:59:27.956Z
tags: 
editor: undefined
dateCreated: 2020-11-27T11:01:20.444Z
-->

<!DOCTYPE html>
<html>
    <head>
        <title>Blueberry Group : A5:2017 - Broken Access Control</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">Blueberry Group</a></span>
                            </li>
                                                    <li>
                                <span><a href="Blueberry-Web-Template_85492520.html">Blueberry Web Template</a></span>
                            </li>
                                                    <li>
                                <span><a href="BBWT3_85492530.html">BBWT3</a></span>
                            </li>
                                                    <li>
                                <span><a href="BBWT3---Security_85493287.html">BBWT3 - Security</a></span>
                            </li>
                                                    <li>
                                <span><a href="85493303.html">BBWT3 - Application Security / Monitoring</a></span>
                            </li>
                                                    <li>
                                <span><a href="BBWT3---Security-Items_85493309.html">BBWT3 - Security Items</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            Blueberry Group : A5:2017 - Broken Access Control
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
        
    
        
        
            Created by <span class='author'> Jason Cozza</span> on Sep 22, 2020
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <h1 id="A5:2017-BrokenAccessControl-Overview">Overview</h1><p>A flawed access control may be caused by unenforced user restrictions and this allows attackers to exploit and access unauthorized functionality or data. Access control is meant to control what “authorized” users are allowed and not allowed to do within an app. As well as establish proper access control, the app must ensure that it is performing solid authorization checks, and that proper authentication is in place to tell which users are privileged and which are in fact random internet users.</p><p>Broken access control may be due to that developers often fall to the difficulty of implementing a proper access control with all of the rules in place. And in various cases, access control rules are placed throughout the code and the collection of rules becomes scattered and nearly impossible to follow and understand.</p><h1 id="A5:2017-BrokenAccessControl-Example">Example</h1><p>The application uses unverified data in a SQL call that is accessing account information:</p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><td class="confluenceTd"><p><code class="csharp plain">stmt.setString(1, request.getParameter(</code><code class="csharp string">&quot;acct&quot;</code><code class="csharp plain">));</code><br/><code class="csharp plain">ResultSet results = pstmt.executeQuery( );</code></p></td></tr></tbody></table></div><p>An attacker simply modifies the 'acct' parameter in the browser to send whatever account number they want. If not properly verified, the attacker can access any user's account:</p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><td class="confluenceTd"><p><code class="csharp plain">http:</code><code class="csharp comments">//<a class="external-link" href="http://example.com/app/accountInfo?acct=notmyacct" rel="nofollow">example.com/app/accountInfo?acct=notmyacct</a></code></p></td></tr></tbody></table></div><h1 id="A5:2017-BrokenAccessControl-HowBBWT3MitigatesThisAttack">How BBWT3 Mitigates This Attack</h1><ul><li>Through the use of groups and roles.</li><li>Through the use of 2FA.</li><li>With the use of an IP whitelist account access of admins are restricted to only be used from e.g. the internal network. This improves unauthorised access by denying automatically an admin role from anywhere except on the IP whitelist.</li><li>Impersonation - BBWT3 has the ability to check each user level to ensure they only have access to what they need.</li><li>Verifiable through the &quot;Routes Access&quot; page.</li><li>Obfuscated URL ID's.<br/><br/></li></ul><p>Two important ways that BBWT3 manages access permissions is through what are called groups and roles. A role permits a user to access certain types of data, while a group permits access to certain data. For example an individual may belong to the sales team group, but also has the role of manager. In this example they would be able to see all the sales transactions from their store, but not from the whole company.</p><p>Any individual user may belong to many roles and/or many groups. Roles are the simplest kind of security, they protect the API function's by simply stating, &quot;if you are not on the role list then you are not permitted to access <em>any</em> data&quot;. Elsewhere on this wiki there are full details of the <a href="https://wiki.bbconsult.co.uk/display/BLUEB/Security" rel="nofollow">access control architecture</a> under BBWT3. </p><p>2FA (Two Factor Authentication), through the use of tokens, can be used with accounts to prevent unauthorised access from stolen usernames and passwords. Ensuring that only the authorised user is able to login to their account.</p><p>An IP whitelist can be used. This is where only specific IP addresses, or IP ranges, are permitted to use a certain account. For example you might only wish to have an admin be able to login from your business IP address. This would blanket ban any other login attempt for that account from any IP that does not come from within your own network. This enhances security by adding an additional security layer that an attacker must first overcome before attempting to access an admin account.</p><p>With the use of BBWT3's built in &quot;Impersonation&quot; feature, you can quickly see what each role is able to see and interact with. This is a quick and dirty way to test that all permissions are correct for each role. However, it must be stressed that this is not a substitute for manually checking whether each page is available to them via altering the users browser URL.</p><p>The &quot;Routes Access&quot; page is a vitally important tool in aiding the project manager in reviewing what routes are available to which <em>roles.  </em>It displays which pages <em>and APIs</em> are available to which roles, going from &quot;open to the world&quot;, to &quot;admins only&quot;. In time, we expect to develop this further to help view other access control rules. The application reads its own code to find out what security has been applied. </p><p>URL ID's are obfuscated through the use of a token which is a generated hash of the real order ID plus an individual salt for each type. This means that it will be impossible for an attacker to guess incrementing ID's such as those found with an order number. For example in an un-obfuscated URL ID with &quot;<a class="external-link" href="http://webapp.com/order=21" rel="nofollow">webapp.com/order=21</a>&quot; an attacker could change the value to see if they can access another order, e.g. &quot;<a class="external-link" href="http://webapp.com/order=20" rel="nofollow">webapp.com/order=20</a>&quot;. With the token that BBWT3 uses, the order number will be followed a jumble of hexadecimal characters which the application <em>automatically</em> uses to spot a request that is attempting to bypass the UI. This <em>helps</em> limit damage if the actual access control on the resource has not been implemented. It is not a substitute for access control.</p><h1 id="A5:2017-BrokenAccessControl-OtherResources">Other Resources</h1><p>OWASP 2017 full details -  page 10 of <a class="external-link" href="https://www.owasp.org/images/7/72/OWASP_Top_10-2017_%28en%29.pdf.pdf" rel="nofollow">https://www.owasp.org/images/7/72/OWASP_Top_10-2017_%28en%29.pdf.pdf</a> </p>
                    </div>

                    
                 
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Nov 27, 2020 10:56</p>
                    <div id="footer-logo"><a href="http://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
