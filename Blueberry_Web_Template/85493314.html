<!--
title: A2:2017 - Broken Authentication
description: 
published: true
date: 2020-12-02T14:55:38.837Z
tags: 
editor: undefined
dateCreated: 2020-11-27T11:01:11.907Z
-->

<h1>Blueberry Group : A2:2017 - Broken Authentication&nbsp;</h1>
<p>Created by Jason Cozza on Sep 22, 2020</p>
<h1>Overview<br>&nbsp;</h1>
<p>When an application’s functions are not implemented correctly, the attack surface is open for criminals to easily break in and compromise passwords, session IDs, and exploit other flaws using stolen credentials. Sessions should be unique to each individual user, and without some necessary session management, an attacker can sneak in, disguised as a user to steal tokens and passwords to gain the access they are after. Attacks such as brute-force or credential stuffing can be used on web applications that have not correctly implemented preventive measures to these attacks.</p>
<h1>Example</h1>
<p>The Session Hijacking attack consists of the exploitation of the web session control mechanism, which is normally managed for a session token. Because http communication uses many different TCP connections, the web server needs a method to recognize every user’s connections. The most useful method depends on a token that the Web Server sends to the client browser after a successful client authentication.</p>
<figure class="image"><img src="https://www.owasp.org/images/c/cb/Session_Hijacking_3.JPG"></figure>
<h1>How BBWT3 Mitigates This Vulnerability</h1>
<ul>
  <li>For the specific example above,&nbsp;the token is transmitted in encrypted form,&nbsp;and is time-limited. Time limiting the validity of the tokens means that you don't just have the problem of cracking the encryption, you have to do it fast. Only attackers with access to excessive amounts of computing power could attempt such a feat.</li>
  <li>Account time outs - account will have a cool down period after too many failed attempts.</li>
  <li>Requires strong passwords - with rules and checks against character rules (lower, upper, symbol and digit),&nbsp;zxcvbn&nbsp;and optionally the HIBP database.<br><br>&nbsp;</li>
</ul>
<p>BBWT3 secures its authentication process by preventing brute-force attacks. It does this by ensuring that an account with too many failed password attempts is placed in a state of cool down. This means that an attacker can only perform a certain amount of brute-force attempts against an individual account before having to wait. The waiting time is set by default to 10 seconds. This ensures that a legitimate user will not have to wait too long before attempting to try again. But at the same time severely hinders the use of a brute-force attack by an attacker.</p>
<p>In addition when a user registers for an account their password is checked against certain rules for determining strength. It will use the normal rules of&nbsp; lowercase, uppercase, digits and symbols, along side the zxcvbn algorithm that checks for the most common passwords and patterns and gives them a rating. If the password entered is deemed too insecure by zxcvbn then a user will be unable to register with that password. Also there is the option to use the HIBP (Have I Been Pwnd) database, this is the culmination of all widely known leaked passwords compiled into one searchable database. If the user uses a password found in the HIBP database they will be alerted to it, and told never to use that password again.</p>
<p>BBWT3 has the ability to use 2FA (Two Factor Authentication). This is done through the use of tokens, either in software or hardware. Software tokens are done through the use of apps such as Google Authenticator while hardware tokens are done through the use of special USB keys. Both work by providing one time only passwords to an associated account.&nbsp; This way you can ensure that the person logging into the account is the intended authorised user.</p>
<p>Additionally, in BBWT3 cookies are made tamper-proof, preventing an attacker from changing data that the server might otherwise erroneously trust them.&nbsp;When the server creates token data for a cookie it "signs" it using a hash and private key. When the token returns, the server rejects any data content that would not result in the hash.&nbsp;</p>
<p>Together these features mitigate weaknesses that can be found in other web applications with weaker authentication methods and practises.</p>
<h1>Other Resources</h1>
<p>OWASP 2017 full details -&nbsp; page 8 of&nbsp;<a href="https://www.owasp.org/images/7/72/OWASP_Top_10-2017_%28en%29.pdf.pdf">https://www.owasp.org/images/7/72/OWASP_Top_10-2017_%28en%29.pdf.pdf</a>&nbsp;</p>
<p>Document generated by Confluence on Nov 27, 2020 10:56</p>
<p><a href="http://www.atlassian.com/">Atlassian</a></p>
