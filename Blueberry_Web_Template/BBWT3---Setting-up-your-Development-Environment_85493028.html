<!--
title: BBWT3---Setting-up-your-Development-Environment_85493028
description: 
published: true
date: 2020-12-02T11:57:27.672Z
tags: 
editor: undefined
dateCreated: 2020-11-27T11:06:50.831Z
-->

<!DOCTYPE html>
<html>
    <head>
        <title>Blueberry Group : BBWT3 - Setting up your Development Environment</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">Blueberry Group</a></span>
                            </li>
                                                    <li>
                                <span><a href="Blueberry-Web-Template_85492520.html">Blueberry Web Template</a></span>
                            </li>
                                                    <li>
                                <span><a href="BBWT3_85492530.html">BBWT3</a></span>
                            </li>
                                                    <li>
                                <span><a href="BBWT3---Development-Environment_85493024.html">BBWT3 - Development Environment</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            Blueberry Group : BBWT3 - Setting up your Development Environment
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
        
    
        
        
            Created by <span class='author'> Jason Cozza</span> on Sep 21, 2020
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <h1 class="auto-cursor-target" id="BBWT3-SettingupyourDevelopmentEnvironment-Overview">Overview</h1><p>This page details how to correctly set up your system for coding BBWT3. It has links to the relevant information and files. If you leave this page to complete a section e.g. to install Git, ensure that you return here and follow from where you left off - especially if you get stuck.</p><p><br/></p><p><strong>1. Install <a class="external-link" href="https://nodejs.org/en/download/package-manager/" rel="nofollow">Node.js</a> and <a class="external-link" href="https://dotnet.microsoft.com/download/dotnet-core/3.1" rel="nofollow">.NET Core SDK 3.1</a><br/></strong></p><p>Node.js provides the <code>npm</code> command used to fetch the JavaScript libraries and tools such as Angular and TypeScript compiler.</p><p>.NET Core SDK provides the runtime and compiler for ASP.NET Core alongside the command used to fetch packages from the NuGet repository. Verify the installation succeeded by running:</p><p><br/></p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><td class="confluenceTd"><p><code class="csharp plain">dotnet --info.</code></p></td></tr></tbody></table></div><p><br/></p><p><strong>2. Generate a Public/Private SSH Key and Setup GitLab</strong></p><p>Follow the instructions in this <a href="https://wiki.bbconsult.co.uk/display/BLUEB/Using+Git" rel="nofollow">section</a>.</p><p>TortoiseGit users: TortoiseGit uses keys in PuTTY format (.ppk) and you will need to convert your public key to a .ppk format. For additional info about this please see <a class="external-link" href="https://stackoverflow.com/questions/27129904/pageant-refuses-to-load-ssh-2-key-generated-with-gitbash" rel="nofollow">here</a>.</p><p><strong>3. Install <a href="https://wiki.bbconsult.co.uk/display/BLUEB/Using+Git" rel="nofollow">Git</a></strong></p><p>If you're using Windows, chances are that you don't have Git installed.</p><p><strong>4. Clone the Repository</strong></p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><td class="confluenceTd"><p><code class="xml plain">git clone <a class="external-link" href="https://gitlab.bbconsult.co.uk/blueberry/bbwt3" rel="nofollow">https://gitlab.bbconsult.co.uk/blueberry/bbwt3</a></code></p></td></tr></tbody></table></div><p class="auto-cursor-target"><strong><br/></strong></p><p><strong>6. Checkout the 'develop' Branch</strong></p><p>First change directory to the Git repository you just cloned:</p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><td class="confluenceTd"><p><code class="csharp plain">cd bbwt3</code></p></td></tr></tbody></table></div><p><br/>Now change to the 'develop' branch:</p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><td class="confluenceTd"><p><code class="csharp plain">git checkout develop</code></p></td></tr></tbody></table></div><p class="auto-cursor-target">The main branch (<code>master</code>) is generally intended to contain stable code. The latest changes are available on the development branches, starting at <code>develop</code>.</p><p style="margin-left: 30.0px;"><strong><br/></strong></p><p><strong>7. Install NPM Dependencies</strong></p><p>Change directory to the BBWT.Client project:</p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><td class="confluenceTd"><p><code class="csharp plain">cd project/BBWT.Client</code></p></td></tr></tbody></table></div><p><br/></p><p>Note, if you use Windows then you may have issues with the node-sass package installation, to avoid that you should run this command before installing NPM dependencies:</p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><td class="confluenceTd"><p><code class="csharp plain">npm install --global --production windows-build-tools</code></p></td></tr></tbody></table></div><p><br/></p><p>Now install NPM dependencies:</p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><td class="confluenceTd"><p><code class="csharp plain">npm install</code></p></td></tr></tbody></table></div><p><strong><br/></strong></p><p><strong>8. Install NuGet Dependencies</strong></p><p>Change directory to the BBWT.Server project:</p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><td class="confluenceTd"><p><code class="csharp plain">cd project/BBWT.Server</code></p></td></tr></tbody></table></div><p>Now restore dependencies:</p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><td class="confluenceTd"><p><code class="csharp plain">dotnet restore</code></p></td></tr></tbody></table></div><p><br/></p><p><strong>9. Setting up a database server</strong></p><p>Before you continue you need to install an SQL server, either follow instructions for<strong> MySQL</strong> or <strong>MS SQL</strong>.<br/>Do not use MariaDB as this will cause issues later on when changing the encoding.</p><p class="x_MsoNormal">If you don't have one, it can be done by installing it locally. Follow the set up guide for either Linux or Windows.</p><p class="x_MsoNormal"><br/></p><p><br/></p><p><strong>10. Connecting the Application to the Database</strong></p><p class="x_MsoNormal">Now you will need to specify how to connect BBWT3 to the database. To do that in Development mode, you will need to create a specific app settings file.</p><ol><li class="x_MsoNormal">From the BBWT3 directory, copy the <em>project/BBWT.Server/appsettings.development.json.template</em> file and rename it <em>appsettings.development.json</em> </li><li class="x_MsoNormal">In the file project/BBWT.Server/appsettings.development.json, set your connection string as in the below examples.</li></ol><p style="margin-left: 30.0px;"><strong><br/></strong></p><p style="margin-left: 30.0px;"><strong>MySQL Example</strong></p><p>This is an example of an app settings file for a MySQL server running in Docker, being exposed to the host over port 5001.</p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><td class="confluenceTd"><p><code class="csharp plain">{</code><br/><code class="csharp spaces">  </code><code class="csharp string">&quot;DatabaseConnectionSettings&quot;</code><code class="csharp plain">: {</code><br/><code class="csharp spaces">    </code><code class="csharp string">&quot;DatabaseType&quot;</code><code class="csharp plain">: </code><code class="csharp string">&quot;MySql&quot;</code><code class="csharp plain">,</code><br/><code class="csharp spaces">    </code><code class="csharp string">&quot;MaxRetryCount&quot;</code><code class="csharp plain">: 10,</code><br/><code class="csharp spaces">    </code><code class="csharp string">&quot;MaxRetryDelay&quot;</code><code class="csharp plain">: 30</code><br/><code class="csharp spaces">  </code><code class="csharp plain">},</code><br/><code class="csharp spaces">  </code><code class="csharp string">&quot;ConnectionStrings&quot;</code><code class="csharp plain">: {</code><br/><code class="csharp spaces">    </code><code class="csharp string">&quot;MySqlConnection&quot;</code><code class="csharp plain">: </code><code class="csharp string">&quot;server=127.0.0.1;port=5001;database=app;Uid=root;Pwd=P@ssword1&quot;</code><code class="csharp plain">,</code><br/><code class="csharp spaces">    </code><code class="csharp string">&quot;DemoMySqlConnection&quot;</code><code class="csharp plain">: </code><code class="csharp string">&quot;server=127.0.0.1;port=5001;database=demo;Uid=root;Pwd=P@ssword1&quot;</code><code class="csharp plain">,</code><br/><code class="csharp spaces">    </code><code class="csharp string">&quot;AuditMySqlConnection&quot;</code><code class="csharp plain">: </code><code class="csharp string">&quot;server=127.0.0.1;port=5001;database=audit;Uid=root;Pwd=P@ssword1&quot;</code><code class="csharp plain">,</code><br/><code class="csharp spaces">    </code><code class="csharp string">&quot;HangfireMySqlConnection&quot;</code><code class="csharp plain">: </code><code class="csharp string">&quot;server=127.0.0.1;port=5001;database=hangfire;Uid=root;Pwd=P@ssword1&quot;</code><br/><code class="csharp spaces">  </code><code class="csharp plain">}</code><br/><code class="csharp plain">}</code></p></td></tr></tbody></table></div><p><br/></p><p style="margin-left: 30.0px;"><strong>MS SQL Example</strong></p><p>This is an example of an app settings file for an MS SQL server running in Docker, being exposed to the host over port 1433.</p><p class="title">Change of Username in Example</p><ul><li>For windows users, change &quot;sa&quot; to &quot;root&quot;, or the user you created with admin privileges when installing MS SQL.</li><li>If you used Docker to install MSSQL Server, user id will be &quot;sa&quot; and the password will be the one provided in the launch command.</li><li>If your password is too weak then MSSQL will not initialise on Linux.</li></ul><p><br/></p><p><br/></p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><td class="confluenceTd"><p><code class="csharp plain">{</code><br/><code class="csharp spaces">  </code><code class="csharp string">&quot;DatabaseConnectionSettings&quot;</code><code class="csharp plain">: {</code><br/><code class="csharp spaces">    </code><code class="csharp string">&quot;DatabaseType&quot;</code><code class="csharp plain">: </code><code class="csharp string">&quot;MsSql&quot;</code><code class="csharp plain">,</code><br/><code class="csharp spaces">    </code><code class="csharp string">&quot;MaxRetryCount&quot;</code><code class="csharp plain">: 10,</code><br/><code class="csharp spaces">    </code><code class="csharp string">&quot;MaxRetryDelay&quot;</code><code class="csharp plain">: 30</code><br/><code class="csharp spaces">  </code><code class="csharp plain">},</code><br/><code class="csharp spaces">  </code><code class="csharp string">&quot;ConnectionStrings&quot;</code><code class="csharp plain">: {</code><br/><code class="csharp spaces">    </code><code class="csharp string">&quot;DefaultConnection&quot;</code><code class="csharp plain">: </code><code class="csharp string">&quot;Data Source=localhost,1433;Initial Catalog=app;Persist Security Info=True;User ID=sa; Password=P@ssword1; Encrypt=False&quot;</code><code class="csharp plain">,</code><br/><code class="csharp spaces">    </code><code class="csharp string">&quot;DemoConnection&quot;</code><code class="csharp plain">: </code><code class="csharp string">&quot;Data Source=localhost,1433;Initial Catalog=demo;Integrated Security=true;User ID=sa; Password=P@ssword1; Encrypt=False&quot;</code><code class="csharp plain">,</code><br/><code class="csharp spaces">    </code><code class="csharp string">&quot;AuditConnection&quot;</code><code class="csharp plain">: </code><code class="csharp string">&quot;Data Source=localhost,1433;Initial Catalog=audit;Persist Security Info=True;User ID=sa; Password=P@ssword1; Encrypt=False&quot;</code><code class="csharp plain">,</code><br/><code class="csharp spaces">    </code><code class="csharp string">&quot;HangfireConnection&quot;</code><code class="csharp plain">: </code><code class="csharp string">&quot;Data Source=localhost,1433;Initial Catalog=hangfire;Persist Security Info=True;User ID=sa; Password=P@ssword1; Encrypt=False&quot;</code><br/><code class="csharp spaces">  </code><code class="csharp plain">}</code><br/><code class="csharp plain">}</code></p></td></tr></tbody></table></div><p><strong>11. Update the Database to the Latest Migration</strong></p><p class="x_MsoNormal">In a console from <em>project/BBWT.Server</em> enter this command to apply all database migrations:<br/><strong>For MySQL Databases</strong></p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><td class="confluenceTd"><p><code class="csharp plain">dotnet ef --project ../BBWT.Data.MySQL -s ./ database update -c DataContext</code></p></td></tr></tbody></table></div><p><br/><strong>For MS SQL Databases</strong></p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><td class="confluenceTd"><p><code class="csharp plain">dotnet ef --project ../BBWT.Data.SqlServer -s ./ database update -c DataContext</code></p></td></tr></tbody></table></div><p class="auto-cursor-target"><strong>Note:</strong></p><p>If you get an error - &quot;Could not execute because the specified command or file was not found.&quot;, that is likely because:</p><p>The dotnet ef tool is no longer a part of the .Net Core SDK</p><p><span style="color: rgb(36,39,41);">This change allows us to ship </span><code>dotnet ef</code><span style="color: rgb(36,39,41);"> as a regular .NET CLI tool that can be installed as either a global or local tool.</span></p><p><span style="color: rgb(36,39,41);">For example, to be able to manage migrations or scaffold a </span><code>DbContext</code><span style="color: rgb(36,39,41);">, install </span><code>dotnet ef</code><span style="color: rgb(36,39,41);"> as a global tool typing the following command:</span><br/><strong>Install dotnet ef tool</strong></p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><td class="confluenceTd"><p><code class="csharp plain">dotnet tool install --global dotnet-ef</code></p></td></tr></tbody></table></div><p>For a specific version add the flag --version in the end, e.g. &quot;<span class="pun">--</span><span class="pln">version </span><span class="lit">3.1</span><span class="pun">.</span><span class="lit">4&quot;</span></p><p><span class="lit"><br/></span></p><p><span class="lit"><br/></span></p><p><strong><br/></strong></p><p><strong>12. Obtain list</strong></p><p>In order to display a list of database contexts, you first need to copy the <strong>appsettings.json</strong> and <strong>appsettings.development.json</strong><em> </em>from the project<em>/BBWT.Server</em> folder into the project<em>/BBWT.Data.&lt;your-database-provider&gt; </em>folder. <em>(BBWT.Data.MySQL </em><u>or</u><em> BBWT.Data.SqlServer)</em></p><p><span>In a console from <em>project</em></span><em>/<em>BBWT.Data.<em>&lt;your-database-provider&gt;</em></em></em><span> enter this command to apply all database migrations:</span><br/><strong>Obtain list of database contexts</strong></p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><td class="confluenceTd"><p><code class="csharp plain">dotnet ef migrations list</code></p></td></tr></tbody></table></div><p>Dotnet EF will use the environment specified in ASPNETCORE_ENVIRONMENT (Development if not specified), so make sure the app settings file is filled out correctly.</p><p>If you've built the project recently, you can speed up dotnet ef by including --no-build on the command line, as dotnet ef likes to build the project every time you run it by default.<br/><strong>Obtain list of migrations</strong></p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><td class="confluenceTd"><p><code class="csharp plain">dotnet ef migrations list -c DataContext</code></p></td></tr></tbody></table></div><p><br/></p><p>If the build succeeds, then your local copy of the project should be ready to run.</p><p><br/></p><p><strong>If You Get the Error Message:</strong><span style="color: rgb(255,0,0);"> More than one DbContext was found.</span></p><p><br/></p><p class="title">For Linux</p><p>There is a bug on Linux where it creates threads but does not kill them. Confirmed on Debian based systems.</p>
                    </div>

                    
                 
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Nov 27, 2020 10:56</p>
                    <div id="footer-logo"><a href="http://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
