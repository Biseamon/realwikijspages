<!DOCTYPE html>
<html>
    <head>
        <title>Blueberry Group : A8:2017 - Insecure Deserialization</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">Blueberry Group</a></span>
                            </li>
                                                    <li>
                                <span><a href="Blueberry-Web-Template_85492520.html">Blueberry Web Template</a></span>
                            </li>
                                                    <li>
                                <span><a href="BBWT3_85492530.html">BBWT3</a></span>
                            </li>
                                                    <li>
                                <span><a href="BBWT3---Security_85493287.html">BBWT3 - Security</a></span>
                            </li>
                                                    <li>
                                <span><a href="85493303.html">BBWT3 - Application Security / Monitoring</a></span>
                            </li>
                                                    <li>
                                <span><a href="BBWT3---Security-Items_85493309.html">BBWT3 - Security Items</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            Blueberry Group : A8:2017 - Insecure Deserialization
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
        
    
        
        
            Created by <span class='author'> Jason Cozza</span> on Sep 22, 2020
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <h1 id="A8:2017-InsecureDeserialization-Overview">Overview</h1><p>According to <a class="external-link" href="https://www.owasp.org/index.php/Deserialization_Cheat_Sheet" rel="nofollow">OWASP</a>, “Serialisation is the process of turning some object into a data format that can be restored later. People often serialise objects in order to save them to storage, or to send as part of communications. Deserialization is the reverse of that process – taking data structured from some format, and rebuilding it into an object.”</p><p>Insecure deserialization often leads to remote code execution. Even if deserialization flaws do not result in remote code execution, they can be used to perform attacks, including replay attacks, injection attacks, and privilege escalation attacks.</p><h1 id="A8:2017-InsecureDeserialization-Example">Example</h1><p>A PHP forum uses PHP object serialization to save a &quot;super&quot; cookie, containing the user's user ID, role, password hash, and other state:</p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><td class="confluenceTd"><p><code class="csharp plain">a:4:{i:0;i:132;i:1;s:7:</code><code class="csharp string">&quot;Mallory&quot;</code><code class="csharp plain">;i:2;s:4:</code><code class="csharp string">&quot;user&quot;</code><code class="csharp plain">;</code><br/><code class="csharp plain">i:3;s:32:</code><code class="csharp string">&quot;b6a8b3bea87fe0e05022f8f3c88bc960&quot;</code><code class="csharp plain">;}</code></p></td></tr></tbody></table></div><p>An attacker changes the serialized object to give themselves admin privileges:</p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><td class="confluenceTd"><p><code class="csharp plain">a:4:{i:0;i:1;i:1;s:5:</code><code class="csharp string">&quot;Alice&quot;</code><code class="csharp plain">;i:2;s:5:</code><code class="csharp string">&quot;admin&quot;</code><code class="csharp plain">;</code><br/><code class="csharp plain">i:3;s:32:</code><code class="csharp string">&quot;b6a8b3bea87fe0e05022f8f3c88bc960&quot;</code><code class="csharp plain">;}</code></p></td></tr></tbody></table></div><h1 id="A8:2017-InsecureDeserialization-HowBBWT3MitigatesThisVulnerability">How BBWT3 Mitigates This Vulnerability</h1><ul><li>Uses where possible JSON files instead of more complex data formats.</li><li>Using named parameters.<br/><br/></li></ul><p>Using JSON files means that the input format is sufficiently simple that it is hard for an attacker to create a trick against the web application.</p><p>Through the use of the Data Transfer Object layer, we specify explicitly and in a degree of detail what types of data we expect to receive from a particular call. Ignoring anything else that isn't expected.</p><h1 id="A8:2017-InsecureDeserialization-OtherResources">Other Resources</h1><p>OWASP 2017 full details -  page 14 of <a class="external-link" href="https://www.owasp.org/images/7/72/OWASP_Top_10-2017_%28en%29.pdf.pdf" rel="nofollow">https://www.owasp.org/images/7/72/OWASP_Top_10-2017_%28en%29.pdf.pdf</a></p>
                    </div>

                    
                 
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Nov 27, 2020 10:56</p>
                    <div id="footer-logo"><a href="http://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
